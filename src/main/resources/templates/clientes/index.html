<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<title>Clients</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
</head>
<body class="bg-light">

<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">UTC Bank</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" 
        aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" href="/clientes"><i class="bi bi-people"></i> Clients</a>
        </li>
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="/cuentas"><i class="bi bi-wallet2"></i> Accounts</a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="container mt-5">
    <div class="d-flex justify-content-between mb-3">
        <h3><i class="bi bi-people"></i> Clients</h3>
        <a href="/clientes/nuevo" class="btn btn-dark"><i class="bi bi-plus-circle"></i> New</a>
    </div>

  <table id="tabla" class="table table-striped">
    <thead class="table-dark">
        <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Email</th>
            <th>CÃ©dula</th>
            <th width="150">Actions</th>
        </tr>
    </thead>
    <tbody>
        <tr th:each="c : ${listaClientes}">
            <td th:text="${c.id}"></td>
            <td th:text="${c.nombre}"></td>
            <td th:text="${c.email}"></td>
            <td th:text="${c.cedula}"></td>
            <td>
                <button class="btn btn-warning btn-sm" th:onclick="'edit(' + ${c.id} + ')'"><i class="bi bi-pencil"></i></button>
                <button class="btn btn-danger btn-sm" th:onclick="'deleteClient(' + ${c.id} + ')'"><i class="bi bi-trash"></i></button>
            </td>
        </tr>
    </tbody>
</table>

</div>

<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
$(document).ready(function() {
    $('#tabla').DataTable({
        language: { url: "//cdn.datatables.net/plug-ins/1.13.6/i18n/en-GB.json" } // English
    });
});

function deleteClient(id) {
    Swal.fire({
        title: 'Delete?',
        text: "This action cannot be undone",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonText: 'Yes',
        cancelButtonText: 'No'
    }).then((r) => { if(r.isConfirmed) window.location='/clientes/eliminar/' + id; });
}

function edit(id) {
    Swal.fire({
        title: 'Do you want to edit?',
        text: "The edit form will open",
        icon: 'question',
        showCancelButton: true,
        confirmButtonText: 'Yes, edit',
        cancelButtonText: 'Cancel'
    }).then((r) => { if(r.isConfirmed) window.location='/clientes/editar/' + id; });
}
</script>

<script th:if="${mensaje}">
Swal.fire({ icon:'[[${tipo}]]', title:'ALERT', text:'[[${mensaje}]]', timer:2500, showConfirmButton:false });
</script>

</body>
</html>
